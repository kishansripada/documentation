---
title: "Context Object Overview"
description: "Programmatically interact with your spreadsheet using the ctx object"
icon: "code"
---

## Introduction

The Context object (`ctx`) provides a powerful API for programmatically interacting with your spreadsheet. It allows you to read and write cell values, manipulate rows, navigate between sheets, and orchestrate complex workflowsâ€”all from within your column formulas.

## Available APIs

<CardGroup cols={2}>
   <Card title="This Row" icon="table-rows" href="/ctx/this-row">
      Get values from the current row
   </Card>
   <Card title="Sheets" icon="table" href="/ctx/sheets">
      Add rows and query data across sheets
   </Card>
   <Card title="Utilities" icon="wrench" href="/ctx/utilities">
      Helper functions for common data transformations
   </Card>
   <Card title="Workflows" icon="traffic-light" href="/ctx/workflow">
      Orchestrate execution with sleep and halt
   </Card>
   <Card title="Webhooks" icon="webhook" href="/webhooks/overview">
      Receive and process HTTP requests in your spreadsheet
   </Card>
</CardGroup>

## Getting Started

The `ctx` object is automatically available in all column formulas:

```typescript
// Get a value from the current row
const email = ctx.thisRow.get("email");

// Add a row to another sheet
const newRow = await ctx.sheet("Contacts").addRow({
   name: ctx.thisRow.get("name"),
   email: email,
   source: "Import",
});

// Query data by value
const company = await ctx.getRowByValue("Companies", "Acme Corp");
```

## Key Features

-  **Row Operations**: Read data from the current row or any row in the sheet
-  **Cross-Sheet Access**: Push data between sheets and query related records
-  **Foreign Key Navigation**: Use dot notation to traverse relationships (e.g., `Companies.Owner.name`)
-  **Workflow Control**: Optimize execution with `halt()` for early termination signals
-  **Type Safety**: Column names and sheet names are validated at runtime

## Context Properties

The `ctx` object includes several key properties:

-  `ctx.rowId` - UUID of the current row
-  `ctx.colId` - UUID of the current column
-  `ctx.thisRow` - Helpers for the current row
-  `ctx.thisSheet` - Helpers scoped to the current sheet
-  `ctx.utils` - Utility functions for data transformation

## Common Patterns

### Enrich Contacts and Link to Accounts

```typescript
// Get contact info from current row
const name = ctx.thisRow.get("Name");
const companyName = ctx.thisRow.get("Company");

// Find or create company account in Accounts sheet
const account = await ctx.sheet("Accounts").addRow({
   "Company Name": companyName,
   Status: "New",
});

// Enrich the contact's LinkedIn profile
const linkedinUrl = await services.person.linkedin.findUrl({
   name,
   company: companyName,
});

if (linkedinUrl) {
   const profile = await services.person.linkedin.enrich({ url: linkedinUrl });
   return profile.job_title;
}
```

### Qualify Leads and Skip Non-ICP

```typescript
// Quick qualification check before expensive enrichment
const companyName = ctx.thisRow.get("Company");
const website = ctx.thisRow.get("Website");

// Scrape and analyze company website
const scraped = await services.scrape.website({ url: website });

const analysis = await services.ai.generateObject({
   prompt: `Based on this website, is ${companyName} in our ICP? 
   Our ICP: B2B SaaS companies, 50-500 employees, selling to enterprises.
   Website: ${scraped.markdown}`,
   schema: z.object({
      isICP: z.boolean(),
      reason: z.string(),
   }),
});

// Signal early termination if not a good fit
if (!analysis.object.isICP) {
   ctx.halt("Not in ICP");
   return false;
}

return true;
```
