---
title: "Apify Integration"
description: "Run specialized Apify actors for advanced scraping tasks"
icon: "robot"
---

## Run Apify Actor

Execute Apify actors for specialized scraping tasks that require more advanced capabilities than basic website scraping.

### Method

```typescript
services.scrape.apify.runActor(params)
```

### Parameters

<ParamField path="actor" type="string" required>
  The Apify actor ID or name to run
</ParamField>

<ParamField path="input" type="any" required>
  Input parameters for the actor (varies by actor)
</ParamField>

<ParamField path="datasetListParams" type="object" optional>
  Parameters for filtering and formatting the dataset results
  
  <Expandable title="Dataset Parameters">
    <ParamField path="limit" type="number">
      Maximum number of results to return
    </ParamField>
    <ParamField path="offset" type="number">
      Number of results to skip
    </ParamField>
    <ParamField path="clean" type="boolean">
      Whether to clean/normalize the data
    </ParamField>
    <ParamField path="fields" type="string[]">
      Specific fields to include in results
    </ParamField>
    <ParamField path="unwind" type="string">
      Field to unwind (flatten nested arrays)
    </ParamField>
  </Expandable>
</ParamField>

### Returns

Returns a `Promise` with the actor's output data. The structure varies depending on the actor used.

## Examples

### Basic Actor Run

```typescript
const results = await services.scrape.apify.runActor({
  actor: "apify/web-scraper",
  input: {
    startUrls: [{ url: "https://example.com" }],
    pageFunction: `
      async function pageFunction(context) {
        return {
          title: context.request.url,
          text: $('body').text()
        };
      }
    `
  }
});

console.log(results);
```

### With Dataset Filtering

```typescript
const results = await services.scrape.apify.runActor({
  actor: "apify/google-search-scraper",
  input: {
    queries: ["artificial intelligence"],
    maxPagesPerQuery: 1
  },
  datasetListParams: {
    limit: 10,
    clean: true,
    fields: ["title", "url", "description"]
  }
});

results.forEach(result => {
  console.log(`${result.title}: ${result.url}`);
});
```

## Common Apify Actors

### Google Search Scraper

```typescript
async function scrapeGoogleResults(query: string, maxResults: number = 10) {
  const results = await services.scrape.apify.runActor({
    actor: "apify/google-search-scraper",
    input: {
      queries: [query],
      maxPagesPerQuery: Math.ceil(maxResults / 10),
      languageCode: "en",
      countryCode: "us"
    },
    datasetListParams: {
      limit: maxResults,
      fields: ["title", "url", "description"]
    }
  });
  
  return results;
}

const searchResults = await scrapeGoogleResults("best CRM software", 20);
```

### Instagram Scraper

```typescript
async function scrapeInstagramProfile(username: string) {
  const results = await services.scrape.apify.runActor({
    actor: "apify/instagram-scraper",
    input: {
      directUrls: [`https://www.instagram.com/${username}/`],
      resultsType: "posts",
      resultsLimit: 50
    },
    datasetListParams: {
      limit: 50,
      fields: ["caption", "timestamp", "likesCount", "commentsCount"]
    }
  });
  
  return results;
}
```

### LinkedIn Scraper

```typescript
async function scrapeLinkedInCompany(companyUrl: string) {
  const results = await services.scrape.apify.runActor({
    actor: "apify/linkedin-company-scraper",
    input: {
      startUrls: [{ url: companyUrl }]
    }
  });
  
  return results[0]; // Usually returns single company object
}
```

### Amazon Product Scraper

```typescript
async function scrapeAmazonProducts(searchTerm: string) {
  const results = await services.scrape.apify.runActor({
    actor: "apify/amazon-crawler",
    input: {
      searchTerms: [searchTerm],
      maxItems: 20
    },
    datasetListParams: {
      fields: ["title", "price", "rating", "url", "asin"]
    }
  });
  
  return results.map(product => ({
    name: product.title,
    price: product.price,
    rating: product.rating,
    url: product.url,
    id: product.asin
  }));
}
```

## Use Cases

### Competitive Price Monitoring

```typescript
async function monitorCompetitorPrices(productName: string) {
  const amazonResults = await services.scrape.apify.runActor({
    actor: "apify/amazon-crawler",
    input: {
      searchTerms: [productName],
      maxItems: 10
    }
  });
  
  const prices = amazonResults.map(item => ({
    source: "Amazon",
    product: item.title,
    price: item.price,
    rating: item.rating
  }));
  
  return prices;
}
```

### Social Media Analytics

```typescript
async function analyzeInstagramEngagement(username: string) {
  const posts = await services.scrape.apify.runActor({
    actor: "apify/instagram-scraper",
    input: {
      directUrls: [`https://www.instagram.com/${username}/`],
      resultsType: "posts",
      resultsLimit: 100
    }
  });
  
  const totalLikes = posts.reduce((sum, post) => sum + post.likesCount, 0);
  const totalComments = posts.reduce((sum, post) => sum + post.commentsCount, 0);
  const avgEngagement = (totalLikes + totalComments) / posts.length;
  
  return {
    username,
    totalPosts: posts.length,
    totalLikes,
    totalComments,
    avgEngagement,
    topPost: posts.sort((a, b) => b.likesCount - a.likesCount)[0]
  };
}
```

### Market Research

```typescript
async function researchMarket(keywords: string[]) {
  const results = await Promise.all(
    keywords.map(keyword =>
      services.scrape.apify.runActor({
        actor: "apify/google-search-scraper",
        input: {
          queries: [keyword],
          maxPagesPerQuery: 2
        },
        datasetListParams: {
          limit: 20
        }
      })
    )
  );
  
  return keywords.map((keyword, i) => ({
    keyword,
    results: results[i],
    topDomains: [...new Set(results[i].map(r => new URL(r.url).hostname))]
  }));
}
```

### Content Aggregation

```typescript
async function aggregateContent(sources: string[]) {
  const results = await services.scrape.apify.runActor({
    actor: "apify/web-scraper",
    input: {
      startUrls: sources.map(url => ({ url })),
      pageFunction: `
        async function pageFunction(context) {
          return {
            url: context.request.url,
            title: $('title').text(),
            content: $('article, .content, main').text(),
            publishDate: $('time').attr('datetime')
          };
        }
      `
    }
  });
  
  return results;
}
```

## Advanced Usage

### Custom Page Function

```typescript
async function customScrape(urls: string[]) {
  const results = await services.scrape.apify.runActor({
    actor: "apify/web-scraper",
    input: {
      startUrls: urls.map(url => ({ url })),
      pageFunction: `
        async function pageFunction(context) {
          const { request, $ } = context;
          
          // Custom extraction logic
          const data = {
            url: request.url,
            title: $('h1').first().text(),
            paragraphs: $('p').map((i, el) => $(el).text()).get(),
            images: $('img').map((i, el) => $(el).attr('src')).get(),
            links: $('a').map((i, el) => $(el).attr('href')).get()
          };
          
          return data;
        }
      `,
      maxConcurrency: 5
    }
  });
  
  return results;
}
```

### Pagination Handling

```typescript
async function scrapeWithPagination(startUrl: string, maxPages: number) {
  const results = await services.scrape.apify.runActor({
    actor: "apify/web-scraper",
    input: {
      startUrls: [{ url: startUrl }],
      maxRequestsPerCrawl: maxPages,
      pageFunction: `
        async function pageFunction(context) {
          const { request, $, enqueueRequest } = context;
          
          // Extract data from current page
          const items = $('.item').map((i, el) => ({
            title: $(el).find('.title').text(),
            price: $(el).find('.price').text()
          })).get();
          
          // Find and enqueue next page
          const nextPageUrl = $('.next-page').attr('href');
          if (nextPageUrl) {
            await enqueueRequest({ url: nextPageUrl });
          }
          
          return items;
        }
      `
    },
    datasetListParams: {
      unwind: "items"
    }
  });
  
  return results;
}
```

## Best Practices

<Tip>
  **Choose the Right Actor**: Apify has specialized actors for different platforms (Instagram, LinkedIn, Amazon, etc.). Use platform-specific actors for better results.
</Tip>

<Warning>
  **Cost Considerations**: Apify actors consume compute units. Complex scraping tasks can be expensive. Always set appropriate limits and test with small datasets first.
</Warning>

<Info>
  **Rate Limiting**: Respect platform rate limits and terms of service. Use appropriate delays and concurrency settings to avoid being blocked.
</Info>

## Error Handling

```typescript
async function runActorSafely(actor: string, input: any) {
  try {
    const results = await services.scrape.apify.runActor({
      actor,
      input,
      datasetListParams: {
        limit: 100,
        clean: true
      }
    });
    
    if (!results || results.length === 0) {
      console.log("No results returned from actor");
      return [];
    }
    
    return results;
  } catch (error) {
    console.error(`Actor ${actor} failed:`, error);
    return [];
  }
}
```

## Performance Optimization

```typescript
// Good: Limit results and specify fields
const optimized = await services.scrape.apify.runActor({
  actor: "apify/web-scraper",
  input: { /* ... */ },
  datasetListParams: {
    limit: 50,
    fields: ["title", "url"], // Only get what you need
    clean: true
  }
});

// Less efficient: Get all data
const unoptimized = await services.scrape.apify.runActor({
  actor: "apify/web-scraper",
  input: { /* ... */ }
  // No dataset params = all data
});
```

